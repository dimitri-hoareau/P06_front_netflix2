<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="carousel.css" />
    <link rel="stylesheet" href="styles.scss" />
    <link rel="stylesheet" href="modal.css" />
    <script src="carousel.js" ></script>
    <script src="movies.js" ></script>

    <title>NetFlix2</title>
</head>

<body>


 </div> 
    <header class="banner">
        <div class="banner__title">
            <h1>JustStreamit</h1>
        </div>
        <nav class="banner__nav">
            <ul class="banner__list">
                <li class="banner__list_element banner__list_element--active">
                    Accueil
                </li>
                <li class="banner__nav__list__element">
                    Catégories
                </li>
            </ul>
        </nav>

    </header>
    <main>
        <section class="best_movie">
            <div class="best_movie__bloc">
                <h2 class="best_movie__title">
                    Titre
                </h2>
                <button class="best_movie__button">
                    Play
                </button>
            </div>
        </section>
    
<section id="carousel_best_movies">
            
    <h1>Films les mieux notés</h1>

    <section  class="carousel" aria-label="Gallery">
        <div class="button__container">
            <button onclick="navigatePrevious('_best-movies')">
                previous
            </button>

            <button onclick="navigateNext('_best-movies')">
            next
        </button>
        </div>
    <ol class="carousel__viewport">

        <li id="carousel__slide0_best-movies"
            tabindex="0"
            class="carousel__slide carousel__slide_best-movies"
            data-active="active">
        </li>
        <li id="carousel__slide1_best-movies"
            tabindex="0"
            class="carousel__slide carousel__slide_best-movies">
        </li>
    </ol>
    <aside class="carousel__navigation">
        <ol class="carousel__navigation-list">
        <li id="carousel__navigation-item_0_best-movies" class="carousel__navigation-item carousel__navigation-item_best-movies" data-active="active" onclick="navigate('carousel__navigation-item_0', 0, '_best-movies')">
            <a href="#carousel__slide0_best-movies"
            class="carousel__navigation-button">Go to slide 1</a>
        </li>
        <li id="carousel__navigation-item_1_best-movies" class="carousel__navigation-item carousel__navigation-item_best-movies" onclick="navigate('carousel__navigation-item_1', 1, '_best-movies')">
            <a href="#carousel__slide1_best-movies"
            class="carousel__navigation-button">Go to slide 2</a>
        </li>
        </ol>
    </aside>
    </section>

    
</section>

<section id="carousel_Action">
            
    <h1>Action</h1>

    <section class="carousel" aria-label="Gallery">
        <div class="button__container">
            <button onclick="navigatePrevious('_Action')">
                previous
            </button>

            <button onclick="navigateNext('_Action')">
            next
        </button>
        </div>
    <ol class="carousel__viewport">

        <li id="carousel__slide0_Action"
            tabindex="0"
            class="carousel__slide carousel__slide_Action"
            data-active="active">
        </li>
        <li id="carousel__slide1_Action"
            tabindex="0"
            class="carousel__slide carousel__slide_Action">
        </li>
    </ol>
    <aside class="carousel__navigation">
        <ol class="carousel__navigation-list">
        <li id="carousel__navigation-item_0_Action" class="carousel__navigation-item carousel__navigation-item_Action" data-active="active" onclick="navigate('carousel__navigation-item_0', 0,'_Action')">
            <a href="#carousel__slide0_Action"
            class="carousel__navigation-button">Go to slide 1</a>
        </li>
        <li id="carousel__navigation-item_1_Action" class="carousel__navigation-item carousel__navigation-item_Action" onclick="navigate('carousel__navigation-item_1', 1, '_Action')">
            <a href="#carousel__slide1_Action"
            class="carousel__navigation-button">Go to slide 2</a>
        </li>
        </ol>
    </aside>
    </section>

</section>



 <!-- vérifier ordre un peu random parfois !!! console.log du tableau final des films -->
 <!-- vire le counter increment -->
 <!-- corriger bouton previous previous quand il n'y a rien avant -->
 <!-- type mot autorisé js ? + modal date published format if = date_published, modification -->
 <!-- fichier js externe modal ??    ordre d'importation faire attention-->


<script>
//create modal content
function buildModal (movieTitle, movieId) {
    // console.log(movieId)
    // regexMovieTitle = movieTitle.replace(/\s/g, "+");
    // fetch("http://localhost:8000/api/v1/titles/?title=" + regexMovieTitle)
    fetch("http://localhost:8000/api/v1/titles/" + movieId)


    .then(function(res) {
        if (res.ok) {
        return res.json();

        }
    })
    .then(function(value) {
        console.log(value)
        // console.log(value.results[0])
        // console.log(value)
        // generateModal(value.results[0])
        generateModal(value)

    })

    .catch(function(err) {
    console.log(err)
    });
}



function generateModal(movieData) {
    let modal = document.createElement("div")
    modal.id = "myModal"
    modal.classList.add("modal")
    document.querySelector('body').appendChild(modal);

    let modalContent = document.createElement("div")
    modalContent.classList.add("modal-content")
    modal.appendChild(modalContent)

    let span = document.createElement("span")
    span.classList.add("close")
    span.textContent = "x"
    modalContent.appendChild(span)

    function getMovieImage (data) {
        let image = document.createElement("img")
        image.src = data
        modalContent.appendChild(image)
    }


    function createModalTextElements(title, data){
        typeOfData = typeof(data)
        let container = document.createElement("div")
        container.className = "modal-content__container--" + typeOfData
        let elementTitle = document.createElement("p")
        elementTitle.textContent = title
        elementTitle.className = "modal-content__container__title"
        let element
        if (typeOfData === "string") {
            element = document.createElement("p")
            element.textContent = data
        } else {
            element = document.createElement("ul")
            if (data === null) {
            }else {

                for (i=0;i<data.length;i++) {
      

                    let elementList = document.createElement("li")
                    elementList.textContent = data[i]
                    element.appendChild(elementList)
                }
            }
    }
        container.appendChild(elementTitle)
        container.appendChild(element)
        modalContent.appendChild(container)
    }


    getMovieImage(movieData.image_url)
    createModalTextElements("titre : ", movieData.title)
    createModalTextElements("genres : ", movieData.genres)
    createModalTextElements("Année : ", movieData.date_published)
    createModalTextElements("votes : ", movieData.votes)
    createModalTextElements("score IMDB : ", movieData.imdb_score)
    createModalTextElements("réalisateurs : ", movieData.directors)
    createModalTextElements("acteurs : ", movieData.actors)
    createModalTextElements("durée : ", movieData.duration)
    createModalTextElements("pays : ", movieData.countries)
    createModalTextElements("résultat au box-office : ", movieData.worldwide_gross_income)
    createModalTextElements("résumé : ", movieData.long_description)



    modal.style.display = "block";

    span.onclick = function() {
    modal.style.display = "none";
    }

// When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        }
    } 
}

function openModal (movieTitle, movieId) {
    buildModal(movieTitle, movieId)
    // modal.style.display = "block";
}




</script>


<!--  durée ? pays d'origine ? resultat boxoffice ? resume ? -->
